<script>

;(function() {
  const zip = (a, b) => a.map((k, i) => [k, b[i]]);
  const zipWith = (f, a, b) => a.map((k, i) => f(k, b[i]));
  const getElementByIdRequired = (id) => {
    const element = document.getElementById(id)
    if (!element) { throw new Error(`no #${id}`) }
    return element
  }

  const userDictionaryFromLanguageReactor_urls = `
  https://www.babla.ru/%D1%81%D0%BF%D1%80%D1%8F%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F/%D0%B8%D1%81%D0%BF%D0%B0%D0%BD%D1%81%D0%BA%D0%B8%D0%B9/WORD
  http://localhost:5000/search?q=WORD
  https://etimologias.dechile.net/?WORD
  `.trim().split('\n')

  const userDictionaryFromLanguageReactor_names = `
  conjucations
  search
  etimology
  `.trim().split('\n')

  const userDictionaryFromLanguageReactor = zipWith((url, name) => ({ url, name }), userDictionaryFromLanguageReactor_urls, userDictionaryFromLanguageReactor_names)

  const inputId = "translation"
  const containerId = "word-dictionaries-container"

  window.renderInContainer = function(spanishWord) {
    const html = userDictionaryFromLanguageReactor.map(({ url, name }) => {
      return `<a target="_blank" href="${url.replace('WORD', encodeURIComponent(spanishWord))}">${name}</a>`
    }).join(', ')
    getElementByIdRequired(containerId).innerHTML = `${spanishWord}: ${html}`
  }

  const inputComponent = getElementByIdRequired(inputId)

  let text = inputComponent.textContent
  text = text.replace(/[áàãâéèêíìîõóòôúùûñ\w]+/gi, match => `<span onclick="window.renderInContainer('${match}')">${match}</span>`)
  inputComponent.innerHTML = text
})();

</script>
